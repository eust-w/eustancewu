---

layout: post
tags: 内存

---

​    
在计算机技术中，虚拟化或虚拟技术是一种资源管理技术，是将计算机的各种实体资源（CPU、内存、磁盘空间、网络适配器等），予以抽象、转换后呈现出来并可供分割、组合为一个或多个电脑配置环境。
​基于内核的虚拟机 Kernel-based Virtual Machine（KVM）是一种内建(在linux kernel源码仓库中)于 Linux中的开源虚拟化技术，也是目前使用广泛的全虚拟化技术，阿里飞天、腾讯云、华为云、opstack、zstack基本都基于KVM技术。
KVM中内存也是允许过载使用（over-commit）的，KVM能够让分配给客户机的内存总数大于实际可用的物理内存总数。由于客户机操作系统及其上的应用程序并非一直100%地利用其分配到的内存，而且宿主机上的多个客户机一般也不会同时达到100%的内存使用率，所以内存过载分配是可行的。一般来说，有如下三种方式来实现内存的过载使用。

1. 内存交换（swapping）：用交换空间（swap space）来弥补内存的不足。
2. 气球（ballooning）：通过virio_balloon驱动来实现宿主机Hypervisor和客户机之间的协作来完成。
3. 页共享（page sharing）：通过KSM（Kernel Samepage Merging）合并多个客户机进程使用的相同内存页。

其中，第一种内存交换的方式是最成熟的（Linux中很早就开始应用），也是目前被广泛使用的，不过，它相比于KSM和ballooning的方式效率较为低一些。

